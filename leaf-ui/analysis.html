
<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf8"/>

        <title>Modelling Tool Prototype</title>

        <link rel="stylesheet" type="text/css" href="./rappid/dist/joint.ui.stencil.css" />
        <link rel="stylesheet" type="text/css" href="./rappid/dist/joint.ui.halo.css" />
        <link rel="stylesheet" type="text/css" href="./rappid/dist/joint.ui.selectionView.css" />
        <link rel="stylesheet" type="text/css" href="./rappid/dist/joint.ui.paperScroller.css" />

        <link rel="stylesheet" type="text/css" href="./rappid/dist/rappid.min.css" />
        <link rel="stylesheet" type="text/css" href="./plugins/slider/nouislider.min.css">

        <link rel="stylesheet" type="text/css" href="./css/style.css" />
        <link rel="stylesheet" type="text/css" href="./css/analysis_style.css" />

    </head>
    <body>
        <p id="name">BloomingLeaf</p>
        <div class="toolbar">
            <button id="btn-zoom-in" class="btn">Zoom In</button>
            <button id="btn-zoom-out" class="btn">Zoom Out</button>
            <button id="btn-svg" class="btn">Open as SVG</button>
            <input type="file" id="loader" style="display:none">

            <button id="btn-save-leaf" class="btn"> Export .leaf </button>

            <div class="dropdown">
              <div class="btn">Font Size</div>
              <div class="dropdown-toolbar">
                <a id="btn-fnt">Default</a>
                <a id="btn-fnt-up">Increase</a>
                <a id="btn-fnt-down">Decrease</a>
              </div>
            </div>

            <div class="dropdown">
              <div class="btn">Help</div>
              <div class="dropdown-toolbar">
                <a onclick="window.open('documentation.pdf'); return false;">Documentation</a>
                <a onclick="window.open('legend.html', 'newwindow', 'width=300, height=250'); return false;">
                Legend</a>
              </div>
            </div>
        </div>


        <div id="paper">
        </div>
        <div class="inspector">
            <div id="layout"></div>
        </div>

        <span id="modeText">Next Steps</span>

        <div id="slider"></div>
        <span id="sliderValue"></span>

		<input id="finalAssigneEpoch" type="hidden"/>
		<input id="finalValueTimePoints" type="hidden"/>
		<input id="elementList" type="hidden"/>
		

        <script type="text/javascript">
            SVGElement.prototype.getTransformToElement = SVGElement.prototype.getTransformToElement || function(toElement) {
            return toElement.getScreenCTM().inverse().multiply(this.getScreenCTM());
        };
        </script>

        <script src="./rappid/lib/jquery/jquery.min.js"></script>
        <script src="./rappid/lib/lodash/lodash.min.js"></script>
        <script src="./rappid/lib/backbone/backbone-min.js"></script>

        <script src="./rappid/dist/rappid.min.js"></script>

        <script src="./rappid/dist/joint.ui.halo.js"></script>
        <script src="./rappid/dist/joint.ui.clipboard.js"></script>
        <script src="./rappid/dist/joint.ui.stencil.js"></script>
        <script src="./rappid/dist/joint.ui.paperScroller.js"></script>
        <script src="./rappid/dist/joint.ui.selectionView.js"></script>
        <script src="./rappid/dist/joint.format.svg.js"></script>
        <script src="./rappid/dist/joint.dia.command.js"></script>

        <script src="./plugins/keyboard/keyboard.js"></script>
        <script src="./plugins/slider/nouislider.min.js"></script>
        <script src="./plugins/chart/Chart.min.js"></script>

        <script src="./objects.js"></script>

        <script src="./rappid-extensions/ElementInspector.js"></script>
        <script src="./rappid-extensions/LinkInspector.js"></script>
        <script src="./rappid-extensions/ConstraintsInspector.js"></script>
        <script src="./rappid-extensions/AnalysisInspector.js"></script>
        <script src="./rappid-extensions/joint.extensions.js"></script>

        <script src="./main.js"></script>
        
		<script src="./js/backendComm.js"></script>
		<script src="./js/analysisComm.js"></script>
		
		<!-- OBJECTS to be sent to backend communication -->
		<script src="./js/object/InputAnalysis.js"></script>
		<script src="./js/object/InputModel.js"></script>
		
		<script src="./js/object/InputActor.js"></script>
		<script src="./js/object/InputConstraint.js"></script>
		<script src="./js/object/InputDynamic.js"></script>
		<script src="./js/object/InputIntention.js"></script>
		<script src="./js/object/InputLink.js"></script>
		
		<!-- Objects used in both ways communication -->
		<script src="./js/object/IOIntention.js"></script>
		<script src="./js/object/IOStatesModel.js"></script>
		
		<!-- Objects received from backend  -->
		<script src="./js/object/OutputModel.js"></script>
		
		<script>
		console.log(JSON.stringify(window.opener.global_analysisResult));
		window.onload = load_analysis_viewew();
		var graphObject = new graphObject();
		function load_analysis_viewew(){
			//SELECT ALL ELEMENTS
			var all_elements = graph.getElements();

			//Filter out Actors
			var elements = [];
			for (var e = 0; e < all_elements.length; e++){
				if (!(all_elements[e] instanceof joint.shapes.basic.Actor))
					elements.push(all_elements[e]);
			}

			//save elements in global variable for slider
			graphObject.allElements = elements;
			
			loadNextStates(window.opener.global_analysisResult);
			
			function loadNextStates(analysisResults){
				currentAnalysis = new analysisObject.nextStates(analysisResults);
				updateSlider(currentAnalysis, false);
			}
			
		};
		</script>
		
        <div class = "attribution">
            <img src=http://upload.wikimedia.org/wikipedia/en/0/04/Utoronto_coa.svg style="width:25%;height:25%;float:left">
            <br>
            Copyright 2015-2017.<br>University of Toronto<br>
            Department of Computer Science. <br>
            All rights reserved.<br>
            <br>
            Powered by: <br>
            <br>
            <img src="./jointjs.png" style="width:25%;height:25%;float:left">
            Copyright 2014-2017.<br>client IO. All rights reserved.<br>
    		JointJS: an HTML 5 diagramming component.<br>
    		<a href=http://jointjs.com target="_blank">http://jointjs.com</a>
        </div>
    </body>
</html>
